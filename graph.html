<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>

<input type="file" id="file-input" accept=".csv"/>
<button id="read-button">Read File</button>
<canvas id="myChart" width="800" height="400"></canvas>

<script>
  document.querySelector("#read-button").addEventListener('click', function() {
    let file = document.querySelector("#file-input").files[0];
    let reader = new FileReader();
    reader.addEventListener('load', function(e) {
      const d = Papa.parse(e.target.result).data.filter(([x, y]) => +x && +y).map(([x, y]) => ({
        x: +x,
        y: +y,
      }));
      drawChart(d);
    });
    reader.readAsText(file);
  });

  let data, chart;

  function drawChart(d) {
    data = {
      labels: d.map((_, i) => i),
      datasets: ['x', 'y'].map(label => ({
        label,
        fill: false,
        data: d.map(x => x[label]),
        borderColor: `rgb(${Math.random() * 255 | 0}, ${Math.random() * 255 | 0}, ${Math.random() * 255 | 0})`,
        pointRadius: 0,
      })),
    };
    chart = new Chart(document.getElementById('myChart'), {
      type: 'line',
      data,
      options: {
        responsive: true,
        maintainAspectRatio: false,
      },
    });
  }
</script>
